"use strict";(self.webpackChunkccm=self.webpackChunkccm||[]).push([[98],{9098:(K,d,i)=>{i.r(d),i.d(d,{UsersModule:()=>V});var u=i(6019),e=i(1514);let T=(()=>{class r{canDeactivate(t){return!!t.canDeactivate()||confirm("WARNING: You have unsaved changes. Press Cancel to go back and save these changes, or OK to lose these changes.")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac}),r})();var w=i(7840),c=i(6663),l=i(9133),m=i(4122),g=i(9327),f=i(9816),_=i(8291),h=i(6459),x=i(5868),A=i(595),v=i(7023);function C(r,n){1&r&&(e.TgZ(0,"span"),e._uU(1,"Please enter email"),e.qZA())}function y(r,n){1&r&&(e.TgZ(0,"span"),e._uU(1,"Email format is wrong"),e.qZA())}function F(r,n){if(1&r&&(e.TgZ(0,"div",21),e.YNc(1,C,2,0,"span",22),e.YNc(2,y,2,0,"span",22),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.ctrlEmail||null==t.ctrlEmail.errors?null:t.ctrlEmail.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.ctrlEmail||null==t.ctrlEmail.errors?null:t.ctrlEmail.errors.email)}}function q(r,n){1&r&&(e.TgZ(0,"span"),e._uU(1," Please Enter Password "),e.qZA())}function b(r,n){1&r&&(e.TgZ(0,"span"),e._uU(1," Err Invalid Password "),e.qZA())}function E(r,n){if(1&r&&(e.TgZ(0,"div",21),e.YNc(1,q,2,0,"span",22),e.YNc(2,b,2,0,"span",22),e.qZA()),2&r){const t=e.oxw(2);let s,o;e.xp6(1),e.Q6J("ngIf",null==(s=t.userForm.get("passGroup.password"))||null==s.errors?null:s.errors.required),e.xp6(1),e.Q6J("ngIf",null==(o=t.userForm.get("passGroup.password"))||null==o.errors?null:o.errors.pattern)}}function I(r,n){1&r&&(e.TgZ(0,"span"),e._uU(1," Please Enter Confirm Password "),e.qZA())}function S(r,n){1&r&&(e.TgZ(0,"span"),e._uU(1," Err Pass Conf Pass Not Match "),e.qZA())}function k(r,n){if(1&r&&(e.TgZ(0,"div",21),e.YNc(1,I,2,0,"span",22),e.YNc(2,S,2,0,"span",22),e.qZA()),2&r){const t=e.oxw(2);let s,o;e.xp6(1),e.Q6J("ngIf",null==(s=t.userForm.get("passGroup.passwordConfirm"))||null==s.errors?null:s.errors.required),e.xp6(1),e.Q6J("ngIf",null==(o=t.userForm.get("passGroup"))||null==o.errors?null:o.errors.match)}}function N(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",2),e.TgZ(1,"div",3),e.TgZ(2,"h6",4),e._uU(3),e.qZA(),e.TgZ(4,"div"),e.TgZ(5,"ul",5),e.TgZ(6,"li"),e.TgZ(7,"a",6),e._uU(8,"User Management"),e.qZA(),e.qZA(),e.TgZ(9,"li"),e._uU(10),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",7),e.TgZ(12,"form",8),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw().onSubmit()}),e.TgZ(13,"div",9),e.TgZ(14,"div",10),e.TgZ(15,"label",11),e._uU(16,"Email"),e.qZA(),e.qZA(),e.TgZ(17,"div",12),e._UZ(18,"input",13),e.YNc(19,F,3,2,"div",14),e.qZA(),e.qZA(),e.ynx(20,15),e.TgZ(21,"div",9),e.TgZ(22,"div",10),e.TgZ(23,"label",11),e._uU(24,"Password"),e.qZA(),e.qZA(),e.TgZ(25,"div",12),e._UZ(26,"input",16),e.YNc(27,E,3,2,"div",14),e.qZA(),e.qZA(),e.TgZ(28,"div",9),e.TgZ(29,"div",10),e.TgZ(30,"label",11),e._uU(31,"Confirm Password"),e.qZA(),e.qZA(),e.TgZ(32,"div",12),e._UZ(33,"input",17),e.YNc(34,k,3,2,"div",14),e.qZA(),e.qZA(),e.BQk(),e.TgZ(35,"div",18),e.TgZ(36,"button",19),e._uU(37),e.qZA(),e.TgZ(38,"a",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().onCancel()}),e._uU(39,"Cancel"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=e.oxw();let s,o;e.xp6(3),e.hij("",t.formMode===t.CopyModeTypes.Create?"Add New ":"Edit"," User"),e.xp6(4),e.Q6J("routerLink","/users/list"),e.xp6(3),e.hij("",t.formMode===t.CopyModeTypes.Create?"Add New ":"Edit"," User"),e.xp6(2),e.Q6J("formGroup",t.userForm),e.xp6(6),e.Q6J("appAutofocus",!0),e.xp6(1),e.Q6J("ngIf",(null==t.ctrlEmail?null:t.ctrlEmail.invalid)&&((null==t.ctrlEmail?null:t.ctrlEmail.dirty)||(null==t.ctrlEmail?null:t.ctrlEmail.touched))),e.xp6(8),e.Q6J("ngIf",((null==(s=t.userForm.get("passGroup.password"))?null:s.touched)||(null==(s=t.userForm.get("passGroup.password"))?null:s.dirty))&&!(null!=(s=t.userForm.get("passGroup.password"))&&s.valid)),e.xp6(7),e.Q6J("ngIf",(null==(o=t.userForm.get("passGroup"))?null:o.errors)||((null==(o=t.userForm.get("passGroup.passwordConfirm"))?null:o.touched)||(null==(o=t.userForm.get("passGroup.passwordConfirm"))?null:o.dirty))&&!(null!=(o=t.userForm.get("passGroup.passwordConfirm"))&&o.valid)),e.xp6(2),e.ekj("btn-spinning",t.isFormApiProcessing),e.Q6J("disabled",t.isFormApiProcessing||t.userForm.pristine||!t.userForm.valid),e.xp6(1),e.hij(" ",t.formMode===t.CopyModeTypes.Create?"Create":"Save"," User")}}function M(r,n){1&r&&(e.ynx(0),e._UZ(1,"app-loading-indicator"),e.BQk())}function J(r,n){1&r&&e.GkF(0)}function Y(r,n){if(1&r&&(e.YNc(0,M,2,0,"ng-container",22),e.YNc(1,J,1,0,"ng-container",22)),2&r){const t=e.oxw();e.Q6J("ngIf",t.IsLoading()),e.xp6(1),e.Q6J("ngIf",t.IsFailed())}}function L(r){const n=r.get("password"),t=r.get("passwordConfirm");return(null==n?void 0:n.pristine)||(null==t?void 0:t.pristine)||(null==n?void 0:n.value)===(null==t?void 0:t.value)?null:{match:!0}}let Z=(()=>{class r extends m.H{constructor(t,s,o,a,p,W,X){super(),this.configService=t,this.fb=s,this.usersService=o,this.router=a,this.route=p,this.toaster=W,this.jwtHelper=X,this.isDirty=!1,this.userId=this.route.snapshot.paramMap.get("user-id")||"",this.userForm=this.fb.group({email:["",[l.kI.required,l.kI.email]],passGroup:this.fb.group({password:["",[l.kI.required,l.kI.pattern("(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[$@$!%*?&])[A-Za-zd$@$!%*?&].{7,}")]],passwordConfirm:["",l.kI.required]},{validator:L})}),this.jwtHelper.isTokenExpired()?this.redirectToExternalAuth(this.configService,this.jwtHelper):this.setPageTitle("Add User")}get f1(){return this.userForm.controls}get ctrlEmail(){return this.userForm.get("email")}ngOnInit(){if(this.userForm.valueChanges.subscribe(t=>this.isDirty=!0),!this.func.IsEmptyString(this.userId))return this.formMode=this.CopyModeTypes.Edit,void this.fetchUser();this.setDispSuccess()}canDeactivate(){return this.isDirty}onSubmit(){this.isFormApiProcessing=!0,this.usersService.createUser({email:this.userForm.value.email,temp_password:this.userForm.value.passGroup.password}).subscribe({next:()=>{this.isFormApiProcessing=!1,this.toaster.show("success","user created successfully"),this.router.navigate([g.PATH_USERS])},error:()=>{this.toaster.show("error","Unable to create user. Retry.")}})}onCancel(){this.userForm.dirty?this.func.askUserSwal("Are you sure want to discard the changes?").then(t=>{t.value&&this.redirectToParent()}):this.redirectToParent()}redirectToParent(){this.router.navigate(["/users/list"])}fetchUser(){var t;this.setDispLoading(),null===(t=this.usersService.getUsers())||void 0===t||t.subscribe({next:s=>{if(!this.hasValidResult(s))return void this.setDispFailed();const o=s.result.filter(a=>a.Username===this.userId)[0];this.userForm.patchValue({email:this.func.GetUserEmail(o)}),this.setDispSuccess()}})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(f.E),e.Y36(l.qu),e.Y36(_.f),e.Y36(c.F0),e.Y36(c.gz),e.Y36(h.M),e.Y36(x.N0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-form"]],features:[e.qOj],decls:3,vars:2,consts:[["class","w-full",4,"ngIf","ngIfElse"],["altLoadingStates",""],[1,"w-full"],[1,"px-4","py-2","border-b"],[1,"text-lg","font-semibold","custom-title-font"],["id","breadcrumbs",1,"text-sm"],[1,"pointer",3,"routerLink"],[1,"mx-5","my-3","shadow-md","py-3"],[1,"pt-4","px-5",3,"formGroup","ngSubmit"],[1,"mb-7","mx-5","flex","flex-col","lg:flex-row","md:flex-row","lg:items-center","md:items-center"],[1,"w-full","lg:w-1/3","md:w-1/3"],[1,"text-sm","text-gray-700","font-medium"],[1,"w-full","lg:w-1/2","md:w-1/2"],["type","email","formControlName","email","maxlength","50",1,"border","rounded","px-4","py-3","w-full","text-sm","text-gray-500",3,"appAutofocus"],["class","invalid-feedback",4,"ngIf"],["formGroupName","passGroup"],["type","password","formControlName","password",1,"border","rounded","px-4","py-3","w-full","text-sm","text-gray-500"],["type","password","formControlName","passwordConfirm",1,"border","rounded","px-4","py-3","w-full","text-sm","text-gray-500"],[1,"py-3","my-3","mx-5","flex","items-center"],["type","submit",1,"bg-green-500","rounded","px-12","py-3","text-white","text-sm","hover:bg-green-400","tracking-wider","mr-3","progress-btn",3,"disabled"],[1,"pointer","bg-gray-200","rounded","px-12","py-3","text-gray-700","text-sm","hover:bg-gray-300","tracking-wider","mr-3",3,"click"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(t,s){if(1&t&&(e.YNc(0,N,40,12,"div",0),e.YNc(1,Y,2,2,"ng-template",null,1,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",s.IsSuccess())("ngIfElse",o)}},directives:[u.O5,c.yS,l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,l.nD,A.U,l.x0,v.Q],encapsulation:2}),r})();var U=i(2501),Q=i(1784);const G=function(r,n,t){return{"bg-green-500":r,"bg-red-500":n,"bg-yellow-500":t}};function O(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"a",21),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"td"),e.TgZ(5,"span",22),e._uU(6),e.qZA(),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td"),e.TgZ(11,"ul",23),e.TgZ(12,"li",24),e.TgZ(13,"a",25),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).askDeleteUser(a.Username)}),e.O4$(),e.TgZ(14,"svg",26),e._UZ(15,"path",27),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=n.$implicit,s=e.oxw(3);e.xp6(3),e.Oqu(s.func.GetUserEmail(t)),e.xp6(2),e.Q6J("ngClass",e.kEZ(7,G,"CONFIRMED"===t.UserStatus,"SUSPEND"===t.UserStatus,"FORCE_CHANGE_PASSWORD"===t.UserStatus)),e.xp6(1),e.hij(" ",s.getStatus(t),""),e.xp6(2),e.Oqu(e.xi3(9,4,t.UserLastModifiedDate,"fullDate"))}}function P(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",10),e.TgZ(1,"div",11),e.TgZ(2,"input",12),e.NdJ("input",function(o){return e.CHM(t),e.oxw(2).onSearchChange(o)}),e.qZA(),e.TgZ(3,"span",13),e.O4$(),e.TgZ(4,"svg",14),e._UZ(5,"path",15),e.qZA(),e.qZA(),e.qZA(),e.kcU(),e.TgZ(6,"table",16),e.TgZ(7,"thead",17),e.TgZ(8,"tr"),e.TgZ(9,"th",18),e._uU(10,"Email"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Status"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Last Modified"),e.qZA(),e.TgZ(15,"th",19),e._uU(16,"Options"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"tbody"),e.YNc(18,O,16,11,"tr",20),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=e.oxw(2);e.xp6(6),e.Q6J("dtOptions",t.dtOptions),e.xp6(12),e.Q6J("ngForOf",t.userList)}}function D(r,n){if(1&r&&(e.ynx(0),e.YNc(1,P,19,2,"div",9),e.BQk()),2&r){const t=e.oxw(),s=e.MAs(13);e.xp6(1),e.Q6J("ngIf",t.userList.length>0)("ngIfElse",s)}}function j(r,n){1&r&&(e.ynx(0),e._UZ(1,"app-loading-indicator"),e.BQk())}function H(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-loading-failed",29),e.NdJ("retryEmitter",function(){return e.CHM(t),e.oxw(2).ngOnInit()}),e.qZA(),e.BQk()}2&r&&(e.xp6(1),e.Q6J("message","Failed to load user list!"))}function R(r,n){if(1&r&&(e.YNc(0,j,2,0,"ng-container",28),e.YNc(1,H,2,1,"ng-container",28)),2&r){const t=e.oxw();e.Q6J("ngIf",t.IsLoading()),e.xp6(1),e.Q6J("ngIf",t.IsFailed())}}function B(r,n){1&r&&e._uU(0," No Users found!\n")}const z=[{path:"list",component:(()=>{class r extends m.H{constructor(t,s,o,a,p){super(),this.configService=t,this.router=s,this.usersService=o,this.toaster=a,this.jwtHelper=p,this.userList=[],this.setPageTitle("User list")}ngOnInit(){this.jwtHelper.isTokenExpired()?this.redirectToExternalAuth(this.configService,this.jwtHelper):this.loadUsers()}ngOnDestroy(){super.ngOnDestroy()}loadUsers(){this.setDispLoading(),setTimeout(()=>{var t;this.query=null===(t=this.usersService.getUsers())||void 0===t?void 0:t.subscribe({next:s=>{this.hasValidResult(s)?(s.result&&(this.userList=s.result),this.setDispSuccess()):this.setDispFailed()},error:()=>{this.setDispFailed()}})},250)}gotoCreateUser(){this.router.navigate([g.PATH_USERS,"add"])}askDeleteUser(t){this.func.IsEmptyString(t)||this.func.askUserSwal("This will delete the user permanently","Are you sure want to delete?").then(s=>{s.value&&this.deleteUser(t)})}getStatus(t){return t.UserStatus}deleteUser(t){this.usersService.deleteUser(t).subscribe({next:s=>{this.hasValidResult(s)?(this.toaster.show("success","User is deleted successfully"),this.ngOnInit()):this.toaster.show("error","unable to delet User! Retry.")}})}onSearchChange(t){this.searchquery=t.target.value,this.datatableElement.dtInstance.then(s=>{s.search(this.searchquery).draw()})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(f.E),e.Y36(c.F0),e.Y36(_.f),e.Y36(h.M),e.Y36(x.N0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-list"]],viewQuery:function(t,s){if(1&t&&e.Gf(U.G,5),2&t){let o;e.iGM(o=e.CRH())&&(s.datatableElement=o.first)}},features:[e.qOj],decls:14,vars:2,consts:[[1,"flex","items-center","justify-between","px-4","py-2","border-b"],[1,"text-black","text-lg","font-semibold"],[1,"bg-green-500","hover:bg-green-400","text-white","rounded","px-3","py-2","text-xs","ml-2","flex","items-center","tracking-wide","pointer",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-2"],[4,"ngIf","ngIfElse"],["altLoadingStates",""],["noUsersTmpl",""],["class","overflow-x-auto mx-5 my-3",4,"ngIf","ngIfElse"],[1,"overflow-x-auto","mx-5","my-3"],[1,"relative","mb-4",2,"width","300px"],["type","text","placeholder","Search User",1,"border","rounded","bg-white","rounded-full","px-4","py-2","text-sm","w-full",3,"input"],[1,"absolute","top-2","right-3"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["datatable","",1,"w-full","text-sm","custom-table","border",3,"dtOptions"],[1,"bg-gray-300"],["width","40%"],["width","3%"],[4,"ngFor","ngForOf"],["click","",1,"hover:underline"],[1,"rounded-full","mr-1","inline-block","text-white","px-2","text-xs",3,"ngClass"],[1,"list-reset","flex","items-center"],[1,"mr-2"],["title","Delete",1,"pointer",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5","text-gray-500","hover:text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[4,"ngIf"],[3,"message","retryEmitter"]],template:function(t,s){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h1",1),e._uU(2,"User Management"),e.qZA(),e.TgZ(3,"div"),e.TgZ(4,"button",2),e.NdJ("click",function(){return s.gotoCreateUser()}),e.O4$(),e.TgZ(5,"svg",3),e._UZ(6,"path",4),e.qZA(),e.kcU(),e.TgZ(7,"span",5),e._uU(8,"New User"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(9,D,2,2,"ng-container",6),e.YNc(10,R,2,2,"ng-template",null,7,e.W1O),e.YNc(12,B,1,0,"ng-template",null,8,e.W1O)),2&t){const o=e.MAs(11);e.xp6(9),e.Q6J("ngIf",s.IsSuccess())("ngIfElse",o)}},directives:[u.O5,U.G,u.sg,u.mk,v.Q,Q.w],pipes:[u.uU],encapsulation:2}),r})()},{path:"edit/:user-id",component:Z},{path:"add",component:Z},{path:"",redirectTo:"list",pathMatch:"full"}];let $=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[c.Bz.forChild(z)],c.Bz]}),r})(),V=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[T],imports:[[w.m,u.ez,$]]}),r})()}}]);